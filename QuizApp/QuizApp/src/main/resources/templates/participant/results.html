<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/custom.css}" rel="stylesheet">
</head>
<body>
<div th:fragment="content">
    <h1>Quiz Results</h1>
    <div class="alert" th:classappend="${result.score >= (result.quiz.questions.size() * 0.7)} ? 'alert-success' : 'alert-danger'">
        <h4>Your Score: <span th:text="${result.score} + '/' + ${#lists.size(result.quiz.questions)}"></span> (<span th:text="${#numbers.formatDecimal((result.score / #lists.size(result.quiz.questions)) * 100, 1, 2)} + '%'"></span>)</h4>
        <p th:if="${result.score >= (result.quiz.questions.size() * 0.7)}">Great job!</p>
        <p th:unless="${result.score >= (result.quiz.questions.size() * 0.7)}">Keep practicing!</p>
    </div>

    <h3>Detailed Breakdown</h3>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Question</th>
            <th>Your Answer</th>
            <th>Correct Answer</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="answer, iter : ${result.answers}" th:with="question=${answer.question}">
            <td th:text="${iter.index + 1} + '. ' + ${question.text}"></td>
            <td th:text="${answer.selectedOption}"></td>
            <td th:text="${question.correctOption}"></td>
            <td th:classappend="${question.correctOption == answer.selectedOption} ? 'text-success' : 'text-danger'"
                th:text="${question.correctOption == answer.selectedOption} ? 'Correct' : 'Incorrect'"></td>
        </tr>
        </tbody>
    </table>

    <div class="mt-4">
        <a th:href="@{/participant/dashboard}" class="btn btn-primary">Back to Dashboard</a>
        <a th:href="@{/participant/past-results}" class="btn btn-secondary">View All Results</a>
    </div>
    <div class="mt-4">
        <a th:href="@{/participant/dashboard}" class="btn btn-primary">Take Another Quiz</a>
        <a th:href="@{/participant/past-results}" class="btn btn-secondary">View Past Results</a>
    </div>
</div>

</body>
</html>